<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الاختبار النهائي - ثانوية قرطبة</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a2a6c; --gold: #b8860b; --bg: #f4f7f6; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        
        /* Quiz Interface */
        .container { max-width: 850px; margin: auto; background: #fff; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        .header-top { background: var(--primary); color: white; padding: 20px; text-align: center; border-bottom: 4px solid var(--gold); }
        .content { padding: 30px; }
        .input-box { width: 100%; max-width: 400px; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 18px; text-align: center; margin-bottom: 20px; font-family: 'Tajawal'; }
        .btn { background: var(--primary); color: white; border: none; padding: 12px 35px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; }
        .btn:hover { background: var(--gold); }
        
        .question-title { font-size: 22px; font-weight: 700; margin-bottom: 25px; line-height: 1.6; }
        .option { display: block; width: 100%; padding: 15px; margin-bottom: 12px; border: 2px solid #eee; border-radius: 10px; text-align: right; cursor: pointer; font-size: 18px; transition: 0.3s; }
        .option:hover { border-color: var(--primary); background: #f9f9f9; }
        .correct { background: #d4edda !important; border-color: #28a745 !important; color: #155724; font-weight: bold; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24; }
        .disabled { pointer-events: none; }

        /* Official Certificate Style */
        #certificate-wrap { display: none; padding: 0; background: #fff; }
        .cert-container { 
            width: 1000px; height: 700px; padding: 40px; border: 20px solid var(--primary); 
            margin: auto; position: relative; background: #fff; 
            box-sizing: border-box; outline: 5px solid var(--gold); outline-offset: -15px;
        }
        .cert-inner { 
            border: 2px solid var(--gold); height: 100%; padding: 30px; text-align: center; 
            background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png');
        }
        .cert-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }
        .cert-header div { text-align: center; font-size: 14px; font-weight: bold; }
        
        .cert-title { font-family: 'Amiri', serif; font-size: 55px; color: var(--primary); margin: 10px 0; }
        .cert-sub { font-size: 22px; color: #333; margin-bottom: 30px; }
        .student-name-cert { font-family: 'Amiri', serif; font-size: 45px; color: var(--gold); border-bottom: 2px solid #333; display: inline-block; min-width: 400px; margin: 15px 0; }
        .cert-body { font-size: 20px; line-height: 1.8; color: #444; margin-top: 20px; }
        .cert-footer { display: flex; justify-content: space-around; margin-top: 60px; font-weight: bold; }
        
        .score-badge { 
            position: absolute; bottom: 40px; right: 40px; width: 120px; height: 120px; 
            border: 4px double var(--gold); border-radius: 50%; display: flex; 
            flex-direction: column; align-items: center; justify-content: center; 
            color: var(--primary); font-weight: bold; transform: rotate(-15deg);
        }

        sub { font-size: 0.6em; }

        @media print {
            body { padding: 0; background: white; }
            .container, .btn, #next-btn { display: none !important; }
            #certificate-wrap { display: block !important; }
            .cert-container { box-shadow: none; border-width: 15px; }
        }
    </style>
</head>
<body>

<div class="container" id="quiz-ui">
    <div class="header-top">
        <h1 style="margin:0">إدارة تعليم الطائف - ثانوية قرطبة</h1>
        <p style="margin:5px 0">مقرر الكيمياء 3 | الاختبار النهائي الشامل</p>
    </div>

    <div class="content">
        <div id="start-screen" style="text-align:center">
            <h2 style="color:var(--primary)">مرحباً بك في اختبار الكيمياء العضوية</h2>
            <p>يتكون الاختبار من 50 سؤالاً تقيس مهاراتك العلمية</p>
            <p style="color:red; font-weight:bold">ملاحظة: الشهادة لا تصدر إلا بالاسم الثلاثي</p>
            <input type="text" id="studentName" class="input-box" placeholder="أدخل اسمك الثلاثي هنا">
            <br>
            <button class="btn" onclick="startTest()">دخول الاختبار</button>
        </div>

        <div id="quiz-screen" style="display:none">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px; font-weight:bold">
                <span id="q-counter">السؤال: 1 / 50</span>
                <span id="score-live">الدرجة: 0</span>
            </div>
            <div id="question-text" class="question-title"></div>
            <div id="options-container"></div>
            <div id="feedback" style="margin-top:20px; font-weight:bold; display:none"></div>
            <button id="next-btn" class="btn" style="display:none; margin-top:20px; float:left" onclick="nextQuestion()">السؤال التالي ←</button>
            <div style="clear:both"></div>
        </div>
    </div>
</div>

<div id="certificate-wrap">
    <div class="cert-container">
        <div class="cert-inner">
            <div class="cert-header">
                <div>المملكة العربية السعودية<br>وزارة التعليم<br>إدارة تعليم الطائف<br>ثانوية قرطبة</div>
                <div><img src="https://upload.wikimedia.org/wikipedia/ar/thumb/2/22/Ministry_of_Education_%28Saudi_Arabia%29_logo.svg/1200px-Ministry_of_Education_%28Saudi_Arabia%29_logo.svg.png" width="100"><br>مكتب تعليم الحوية</div>
                <div>الرقم: ....................<br>التاريخ: <span id="cert-date"></span><br>الموضوع: شهادة تفوق</div>
            </div>

            <h1 class="cert-title">شهادة شكر وتقدير</h1>
            <p class="cert-sub">يسر إدارة ثانوية قرطبة ممثلة في قسم الكيمياء أن تمنح هذه الشهادة للطالب:</p>
            
            <div class="student-name-cert" id="disp-name"></div>

            <div class="cert-body">
                نظير اجتيازه بنجاح باهر **اختبار الكيمياء العضوية الشامل (50 سؤالاً)**<br>
                والذي أعده الأستاذ: <strong>سعود الشلوي</strong><br>
                متمنين له دوام التوفيق والنجاح في مسيرته العلمية.
            </div>

            <div class="cert-footer">
                <div>معلم المادة<br><br>أ. سعود الشلوي</div>
                <div>ختم المدرسة<br><br>...........................</div>
                <div>مدير المدرسة<br><br>...........................</div>
            </div>

            <div class="score-badge">
                <span>التقدير</span>
                <span id="final-grade" style="font-size:24px">ممتاز</span>
                <span id="final-percent">100%</span>
            </div>
        </div>
    </div>
    <div style="text-align:center; margin-top:20px;" class="no-print">
        <button class="btn" style="background:#27ae60" onclick="window.print()">طباعة الشهادة الرسمية (PDF)</button>
    </div>
</div>

<script>
    const questionsPool = [
        { q: "ما الصيغة العامة للألكانات ذات السلسلة المفتوحة؟", a: ["C<sub>n</sub>H<sub>2n+2</sub>", "C<sub>n</sub>H<sub>2n</sub>", "C<sub>n</sub>H<sub>2n-2</sub>", "C<sub>n</sub>H<sub>n</sub>"] },
        { q: "أي المركبات التالية يعتبر من الألكينات؟", a: ["C<sub>2</sub>H<sub>4</sub>", "CH<sub>4</sub>", "C<sub>2</sub>H<sub>6</sub>", "C<sub>3</sub>H<sub>8</sub>"] },
        { q: "تفاعل إضافة الهيدروجين للألكين في وجود محفز يسمى:", a: ["هدرجة", "هلجنة", "أكسدة", "حذف"] },
        { q: "الرابطة في جزيء الإيثاين هي رابطة تساهمية:", a: ["ثلاثية", "أحادية", "ثنائية", "قطبية"] },
        { q: "عند تحويل الألكين إلى ألكان، نوع التفاعل هو:", a: ["إضافة", "استبدال", "حذف", "انتزاع"] },
        { q: "المجموعة الوظيفية المميزة لهاليدات الألكيل هي:", a: ["–X (هالوجين)", "–OH", "–COOH", "–CHO"] },
        { q: "الاسم الصحيح للمركب CH<sub>3</sub>Cl هو:", a: ["كلورو ميثان", "كلورو إيثان", "ميثانول", "ميثانال"] },
        { q: "تفاعل هاليد الألكيل مع NaOH المائي يعطي كحولاً، ما نوع التفاعل؟", a: ["استبدال", "إضافة", "حذف", "أكسدة"] },
        { q: "الكلوروبنزين يصنف ضمن:", a: ["هاليدات الأريل", "هاليدات الألكيل", "الكحولات", "الأمينات"] },
        { q: "لتحضير الأمينات، يتم مفاعلة هاليد الألكيل مع:", a: ["الأمونيا", "الماء", "الصوديوم", "الهيدروجين"] },
        { q: "المجموعة الوظيفية للكحولات تسمى:", a: ["هيدروكسيل", "إيثر", "كربونيل", "أمين"] },
        { q: "الصيغة العامة للإيثرات هي:", a: ["R–O–R", "R–OH", "R–COOH", "R–NH<sub>2</sub>"] },
        { q: "أكسدة الإيثانول أكسدة تامة تعطي:", a: ["حمض إيثانويك", "إيثانال", "إيثين", "ثاني أكسيد الكربون"] },
        { q: "2-بروبانول يعتبر كحولاً:", a: ["ثانوياً", "أولياً", "ثالثياً", "عطرياً"] },
        { q: "نزع الماء من جزيئين من الكحول يؤدي لتكوين:", a: ["إيثر", "إستر", "ألكين", "كيتون"] },
        { q: "المجموعة الوظيفية للكيتونات هي:", a: ["كربونيل وسطية", "هيدروكسيل", "كربوكسيل", "أمين"] },
        { q: "المركب CH<sub>3</sub>CHO يصنف كـ:", a: ["ألدهيد", "كيتون", "كحول", "إيثر"] },
        { q: "عند أكسدة الألدهيدات ينتج:", a: ["حمض كربوكسيلي", "كحول أولي", "كيتون", "ألكان"] },
        { q: "الصيغة العامة للكيتونات هي:", a: ["R–CO–R", "R–CHO", "R–OH", "R–COOH"] },
        { q: "يستخدم كاشف تولن للتمييز بين الألدهيدات و:", a: ["الكيتونات", "الكحولات", "الأحماض", "الإسترات"] },
        { q: "المجموعة الوظيفية للأحماض الكربوكسيلية هي:", a: ["–COOH", "–OH", "–CHO", "–CO–"] },
        { q: "حمض الخليك هو الاسم الشائع لحمض:", a: ["الإيثانويك", "الميثانويك", "البروبانويك", "البوتانويك"] },
        { q: "تفاعل تكوين الإستر يتطلب تفاعل حمض مع:", a: ["كحول", "أمين", "ألكان", "إيثر"] },
        { q: "الصيغة العامة للأحماض الكربوكسيلية هي:", a: ["R–COOH", "R–CHO", "R–CO–R", "R–OH"] },
        { q: "الأكسدة القوية للميثانول تنتج:", a: ["حمض ميثانويك", "ميثانال", "ميثان", "إيثر"] },
        { q: "المجموعة الوظيفية للأمينات هي:", a: ["–NH<sub>2</sub>", "–OH", "–COOH", "–CHO"] },
        { q: "الرابطة التي تربط الأحماض الأمينية في البروتين:", a: ["ببتيدية (أميدية)", "إيثرية", "أيونية", "تساهمية ثنائية"] },
        { q: "تفاعل الحمض مع الأمين ينتج:", a: ["أميد", "إستر", "كيتون", "ألدهيد"] },
        { q: "يعتبر الأنيلين من الأمينات:", a: ["العطرية", "الأليفاتية", "الثانوية", "الثالثية"] },
        { q: "تستخدم الأمينات بكثرة في صناعة:", a: ["الأصباغ", "الوقود", "التبريد", "الأواني"] },
        { q: "المجموعة الوظيفية للإسترات هي:", a: ["–COOR", "–OH", "–COOH", "–CHO"] },
        { q: "تمتاز الإسترات برائحتها التي تشبه:", a: ["الفواكه والأزهار", "البيض الفاسد", "النشادر", "الكلور"] },
        { q: "التحلل المائي للإستر في وسط قاعدي يسمى:", a: ["تصبن", "أسترة", "بلمرة", "هدرجة"] },
        { q: "CH<sub>3</sub>COOCH<sub>3</sub> هو مركب:", a: ["إستر", "إيثر", "كيتون", "حمض"] },
        { q: "نواتج التحلل المائي للإستر في وسط حمضي:", a: ["حمض وكحول", "حمض وأمين", "ألكان وماء", "إيثر وكحول"] },
        { q: "أبسط الكحولات هو:", a: ["ميثانول", "إيثانول", "فينول", "جليسيرول"] },
        { q: "يستخدم الأسيتون كمذيب، وهو برمجياً يسمى:", a: ["بروبانون", "بروبانال", "بروبانول", "حمض البروبانويك"] },
        { q: "البوليمر هو جزيء ضخم يتكون من وحدات:", a: ["مونومرات", "ألكانات", "إسترات", "أيزومرات"] },
        { q: "تفاعل إضافة الكلور للإيثين ينتج:", a: ["1,2-ثنائي كلورو إيثان", "كلورو إيثان", "كلورو إيثين", "ثاني كلورو ميثان"] },
        { q: "تفاعل حذف الماء من الإيثانول يتطلب وجود:", a: ["حمض الكبريتيك", "هيدروكسيد الصوديوم", "النيكل", "الضوء"] },
        { q: "إماهة الإيثين (إضافة الماء) تنتج:", a: ["إيثانول", "إيثان", "إيثانال", "حمض"] },
        { q: "النواتج النهائية لاحتراق أي هيدروكربون هي:", a: ["CO<sub>2</sub> + H<sub>2</sub>O", "CO + H<sub>2</sub>", "C + H<sub>2</sub>", "O<sub>2</sub> + H<sub>2</sub>"] },
        { q: "اختزال الكيتونات ينتج عنه:", a: ["كحول ثانوي", "كحول أولي", "ألكان", "حمض"] },
        { q: "أكسدة الكحول الثانوي تنتج:", a: ["كيتون", "ألدهيد", "حمض", "إيثر"] },
        { q: "يستخدم الفورمالدهيد في حفظ العينات، وصيغته:", a: ["HCHO", "CH<sub>3</sub>OH", "CH<sub>3</sub>COOH", "CH<sub>4</sub>"] },
        { q: "بلمرة الإضافة تحدث للمركبات التي تحتوي روابط:", a: ["ثنائية أو ثلاثية", "أحادية فقط", "أيونية", "فلزية"] },
        { q: "تفاعل حمضين أمينيين يحرر جزيء:", a: ["ماء", "هيدروجين", "أكسجين", "كلور"] },
        { q: "الرابطة في الإيثرات هي رابطة:", a: ["تساهمية قطبية", "أيونية", "هيدروجينية", "فلزية"] },
        { q: "تعتبر الألكانات هيدروكربونات:", a: ["مشبعة", "غير مشبعة", "عطرية", "حلقية"] },
        { q: "المادة البادئة لتكوين البوليمر تسمى:", a: ["مونومر", "أيزومر", "إستر", "كربونيل"] }
    ];

    let currentQuestions = [];
    let currentIdx = 0;
    let score = 0;
    let userName = "";

    function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
    }

    function startTest() {
        const input = document.getElementById('studentName').value.trim();
        if (input.split(/\s+/).length < 3) {
            alert("⚠️ فضلاً، أدخل اسمك الثلاثي لفتح الشهادة الرسمية.");
            return;
        }
        userName = input;
        
        // تجهيز الأسئلة وخلطها
        currentQuestions = questionsPool.map(q => {
            const correct = q.a[0];
            const shuffledOptions = [...q.a];
            shuffle(shuffledOptions);
            return {
                question: q.q,
                options: shuffledOptions,
                correctIdx: shuffledOptions.indexOf(correct)
            };
        });
        shuffle(currentQuestions);

        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        loadQuestion();
    }

    function loadQuestion() {
        const q = currentQuestions[currentIdx];
        document.getElementById('q-counter').innerText = `السؤال: ${currentIdx + 1} / 50`;
        document.getElementById('question-text').innerHTML = q.question;
        
        const container = document.getElementById('options-container');
        container.innerHTML = "";
        q.options.forEach((opt, i) => {
            const div = document.createElement('div');
            div.className = 'option';
            div.innerHTML = opt;
            div.onclick = () => checkAnswer(i, div);
            container.appendChild(div);
        });
        document.getElementById('next-btn').style.display = 'none';
        document.getElementById('feedback').style.display = 'none';
    }

    function checkAnswer(idx, el) {
        const q = currentQuestions[currentIdx];
        const all = document.querySelectorAll('.option');
        all.forEach(opt => opt.classList.add('disabled'));

        if (idx === q.correctIdx) {
            score++;
            el.classList.add('correct');
        } else {
            el.classList.add('wrong');
            all[q.correctIdx].classList.add('correct');
        }
        document.getElementById('score-live').innerText = `الدرجة: ${score}`;
        document.getElementById('next-btn').style.display = 'block';
    }

    function nextQuestion() {
        currentIdx++;
        if (currentIdx < 50) {
            loadQuestion();
        } else {
            showCertificate();
        }
    }

    function showCertificate() {
        document.getElementById('quiz-ui').style.display = 'none';
        document.getElementById('certificate-wrap').style.display = 'block';
        document.getElementById('disp-name').innerText = userName;
        const percent = (score / 50) * 100;
        document.getElementById('final-percent').innerText = percent + "%";
        document.getElementById('cert-date').innerText = new Date().toLocaleDateString('ar-SA');
        
        let grade = "مقبول";
        if (percent >= 90) grade = "ممتاز";
        else if (percent >= 80) grade = "جيد جداً";
        else if (percent >= 70) grade = "جيد";
        document.getElementById('final-grade').innerText = grade;
    }
</script>

</body>
</html>

